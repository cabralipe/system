<!-- Template: professor/confirmacao_agendamento.html -->
{% extends 'base.html' %}

{% block title %}Confirmar Agendamento{% endblock %}

{% block content %}
{% if current_user.tipo == 'professor' %}
    {% set voltar_route = 'routes.adicionar_alunos_professor' %}
{% else %}
    {% set voltar_route = 'routes.adicionar_alunos_participante' %}
{% endif %}
<div class="container mt-4">
    <h2>Confirmar Agendamento</h2>

    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            Resumo do Agendamento
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Evento:</strong> {{ agendamento.horario.evento.nome }}</p>
                    <p><strong>Data:</strong> {{ agendamento.horario.data.strftime('%d/%m/%Y') }}</p>
                    <p><strong>Hor√°rio:</strong>
                        {{ agendamento.horario.horario_inicio.strftime('%H:%M') }} -
                        {{ agendamento.horario.horario_fim.strftime('%H:%M') }}
                    </p>
                </div>
                <div class="col-md-6">
                    <p><strong>Escola:</strong> {{ agendamento.escola_nome }}</p>
                    <p><strong>Turma:</strong> {{ agendamento.turma }}</p>
                    <p><strong>Quantidade de Alunos:</strong>
                        {{ alunos|length }} / {{ agendamento.quantidade_alunos }}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header bg-secondary text-white">
            Alunos
        </div>
        <div class="card-body">
            {% if alunos %}
                <ul class="list-group">
                    {% for aluno in alunos %}
                        <li class="list-group-item">
                            {{ aluno.nome }}{% if aluno.cpf %} (CPF: {{ aluno.cpf }}){% endif %}
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="alert alert-warning">
                    Nenhum aluno cadastrado neste agendamento.
                </div>
            {% endif %}
        </div>
    </div>

    <form method="post"
          action="{{ url_for(
            'agendamento_routes.atualizar_status_agendamento',
            agendamento_id=agendamento.id
          ) }}">
        <input type="hidden" name="status" value="confirmado">
        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-success">
                <i class="fas fa-check"></i> Confirmar
            </button>
            <a href="{{ url_for(
                voltar_route,
                agendamento_id=agendamento.id
            ) }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Voltar
            </a>
        </div>
    </form>
</div>
{% endblock %}
